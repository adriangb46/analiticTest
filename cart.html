<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Carrito Moderno</title>
<!-- Styles -->
<link rel="stylesheet" href="styles.css" />
</head>
<body>

<!-- Bot칩n para abrir carrito -->
<button class="btn btn-primary" onclick="openCart()">Ver Carrito 游</button>

<!-- Modal del Carrito -->
<div id="cartModal">
  <div style="
      background: var(--bg-card);
      max-width: 600px;
      margin: 50px auto;
      padding: var(--space-lg);
      border-radius: var(--radius-lg);
      position: relative;
  ">
    <h2 class="text-center mb-3">Tu Carrito</h2>
    <table style="width:100%; border-collapse: collapse; margin-bottom: var(--space-md);">
      <thead>
        <tr>
          <th style="color:var(--text-secondary); text-align:left;">Producto</th>
          <th style="color:var(--text-secondary); text-align:right;">Precio</th>
          <th style="color:var(--text-secondary); text-align:center;">Cant</th>
          <th style="color:var(--text-secondary); text-align:right;">Subtotal</th>
          <th style="color:var(--text-secondary); text-align:center;">Acciones</th>
        </tr>
      </thead>
      <tbody id="cart-body"></tbody>
    </table>
    <p style="text-align:right;"><strong>Total: $<span id="total">0.00</span></strong></p>
    <div style="text-align:center;">
      <button class="btn btn-secondary" onclick="clearCart()">Vaciar Carrito</button>
      <button class="btn btn-primary" onclick="checkout()">Finalizar Compra</button>
      <button class="btn btn-secondary" onclick="closeCart()">Cerrar</button>
    </div>
  </div>
</div>

<script>
// ------------------------
// Carrito de ejemplo
// ------------------------
if (!sessionStorage.getItem('cart')) {
  const sampleCart = [
    { id: 1, name: 'Camiseta', price: 19.99, quantity: 2 },
    { id: 2, name: 'Pantal칩n', price: 39.99, quantity: 1 },
    { id: 3, name: 'Zapatos', price: 59.99, quantity: 1 }
  ];
  sessionStorage.setItem('cart', JSON.stringify(sampleCart));
}

// ------------------------
// Render del carrito
// ------------------------
function renderCart() {
  const cart = JSON.parse(sessionStorage.getItem('cart')) || [];
  const cartBody = document.getElementById('cart-body');
  const totalEl = document.getElementById('total');

  cartBody.innerHTML = '';
  let total = 0;

  if (cart.length === 0) {
    const row = document.createElement('tr');
    row.innerHTML = `<td colspan="5" style="text-align:center; color:var(--text-secondary);">El carrito est치 vac칤o</td>`;
    cartBody.appendChild(row);
    totalEl.textContent = '0.00';
    return;
  }

  cart.forEach(item => {
    const subtotal = item.price * item.quantity;
    total += subtotal;

    const row = document.createElement('tr');
    row.innerHTML = `
      <td style="color:var(--text-primary);">${item.name}</td>
      <td style="text-align:right; color:var(--accent);">$${item.price.toFixed(2)}</td>
      <td style="text-align:center; color:var(--text-primary);">${item.quantity}</td>
      <td style="text-align:right; color:var(--accent);">$${subtotal.toFixed(2)}</td>
      <td style="text-align:center;">
        <button class="btn btn-secondary" onclick="removeItem(${item.id})">Eliminar</button>
        <button class="btn btn-primary" onclick="increaseQty(${item.id})">+</button>
        <button class="btn btn-primary" onclick="decreaseQty(${item.id})">-</button>
      </td>
    `;
    cartBody.appendChild(row);
  });

  totalEl.textContent = total.toFixed(2);
}

// ------------------------
// Funciones de manipulaci칩n
// ------------------------
function removeItem(id) {
  let cart = JSON.parse(sessionStorage.getItem('cart')) || [];
  cart = cart.filter(item => item.id !== id);
  sessionStorage.setItem('cart', JSON.stringify(cart));
  renderCart();
}

function increaseQty(id) {
  let cart = JSON.parse(sessionStorage.getItem('cart')) || [];
  cart = cart.map(item => item.id === id ? {...item, quantity: item.quantity + 1} : item);
  sessionStorage.setItem('cart', JSON.stringify(cart));
  renderCart();
}

function decreaseQty(id) {
  let cart = JSON.parse(sessionStorage.getItem('cart')) || [];
  cart = cart.map(item => {
    if (item.id === id) {
      return {...item, quantity: Math.max(item.quantity - 1, 1)};
    }
    return item;
  });
  sessionStorage.setItem('cart', JSON.stringify(cart));
  renderCart();
}

function clearCart() {
  sessionStorage.removeItem('cart');
  renderCart();
}

function checkout() {
  alert("Redirigiendo a la p치gina de pago...");
  // Aqu칤 puedes redirigir a /checkout.html por ejemplo
  // window.location.href = "/checkout.html";
}

// ------------------------
// Modal
// ------------------------
function openCart() { 
  document.getElementById('cartModal').style.display = 'block'; 
  renderCart();
}
function closeCart() { document.getElementById('cartModal').style.display = 'none'; }

// ------------------------
// Render inicial
// ------------------------
renderCart();
</script>

</body>
</html>
